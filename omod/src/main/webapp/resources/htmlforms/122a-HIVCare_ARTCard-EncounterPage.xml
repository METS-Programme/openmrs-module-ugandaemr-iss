<htmlform formName="Follow-up Form"
          formDescription="A visit for a client to an ART clinic"
          formEncounterType="8d5b2be0-c2cc-11de-8d13-0010c6dffd0f"
          formUuid="12de5bc5-352e-4faf-9961-a2125085a75c"
          formVersion="2.2"
          formAddMetadata="yes"
          formUILocation="patientDashboard.visitActions"
          formOrder="3"
          formIcon="icon-medkit"
          formShowIf="(visit.active || !visit.active) &amp;&amp; patient.person.dead==false &amp;&amp; sessionLocation.uuid=='86863db4-6101-4ecf-9a86-5e716d6504e4'"
          formDisplayStyle="Standard">
    <style type="text/css">
        .EnableDisabletbstatuschild {
            display: none;
        }

        .error {
            color: red;
        }

        #w30, #w32 {
            display: inline-block;
            width: 10px;
        }

        #w141, #w170 {
            width: 120px;
        }

        table {
            width: 99%;
            display: inline-block;
        }

        table td {
            background: #B6D6E6;
            color: #404040;
            vertical-align: top;
        }

        form#htmlform div.ai-page-frame table tbody td {
            background: #B6D6E6;
            color: #404040;
            padding: 0px 5px;
        }

        form select, .form select {
            min-width: 0px;
        }

        form input, form select, form textarea, form ul.select, .form input, .form select, .form textarea, .form
        ul.select {
            background-color: #FBFBFB;
            border: 1px solid #404040;
            padding: 0px;
        }

        table th, table td {
            border: 1px solid #BDBDBD;
            text-align: left;
            vertical-align: top;
            background: #B6D6E6;
        }

        .card .card-body {
            background: #B6D6E6;
        }

        .section {
            margin: 20px 0px;
        }

        form .lablex {
            width: 93%;
        }

        form .lablex span {
            width: 26%;
            float: left;
            margin: 1px 0px;
        }

        form .lablex2 span {
            min-width: 50%;
            float: left;
            margin: 1px 0px;
        }

        form .lablex3 {
        }

        form .lablex3 span {
            min-width: 50%;
            float: left;
            margin: 1px 0px;
        }

        .hasInlineLabels label {
            display: inline-block;
        }


    </style>
    <!-- jquery loaded for nonessential purposes. -->
    <script type="text/javascript">
        function enable_disable(field, class_name_prefix, conditions, input_type) {

            var class_name = jq(field).attr("class");

            var length = class_name.length;

            var class_id = parseInt(class_name.substring(length - 1, length));
            var childClass = "Child" + class_id;

            var disable = true;
            var requires = true;

            var row = '[class^="' + class_name_prefix + '"][class*="' + childClass + '"]';

            var selected_value = null;

            if (input_type == "select") {
                selected_value = jq(field).find(":selected").text().trim().toLowerCase();
            } else if (input_type == "hidden") {
                selected_value = jq(field).find("input[type=hidden]").val().trim().toLowerCase();
            }


            if (eval(conditions)) {
                disable = false;
            }


            jq(row).each(function () {
                var group = jq(this);

                if (class_name.indexOf('Child') == -1) {
                    /*group.find("input").attr("value", ""); */
                    group.find("input").attr("required", requires);
                    /* group.find('select').prop("selectedIndex", 0);*/
                    group.find("input").attr("disabled", disable);
                    group.find('select').attr("disabled", disable);

                    if (disable) {
                        /* fade out the fields that are disabled */
                        group.find("input").fadeTo(250, 0.25);
                        group.find("select").fadeTo(250, 0.25);
                        } else {
                        /* remove the fade on the fields */
                        group.find("input").fadeTo(250, 1);
                        group.find("select").fadeTo(250, 1);
                    }
                }
            });
        }


        function enable_disable_district_tb_reg(selected_option) {

            var class_name = jq(selected_option).attr("class");

            var length = class_name.length;

            var class_id = parseInt(class_name.substring(length - 1, length))

            var row_id = class_id;

            var disable = true;
            var requires = false;

            var row_1 = '[class^="DistrictTbReg"][class*="Child1"]';

            var xx = row_1;
            var selected_value = jq(selected_option).find(":selected").text()

            selected_value = selected_value.trim().toLowerCase();

            if (selected_value == "tb rx") {
                disable = false;
                requires = true;
            }

            switch (row_id) {
                case 1:
                    xx = row_1;
                    break;
            }


            jq(xx).each(function () {
                var group = jq(this);

                if (class_name.indexOf('Child') == -1) {
                    /* group.find("input").attr("value", ""); */
                    group.find("input").attr("required", requires);
                    /* group.find('select').prop("selectedIndex", 0); */
                    group.find("input").attr("disabled", disable);
                    group.find('select').attr("disabled", disable);
                    if (requires == false) {
                        group.find('.required').show();
                    }
                    else if (requires == true) {
                        group.find('.required').hide();
                    }

                    if (disable) {
                        /* fade out the fields that are disabled */
                        group.find("input").fadeTo(250, 0.25);
                        group.find("select").fadeTo(250, 0.25);
                    } else {
                        /* remove the fade on the fields */
                        group.find("input").fadeTo(250, 1);
                        group.find("select").fadeTo(250, 1);
                    }

                }
            });
        }


        if (jQuery) {
            <!-- Validation rules -->
            beforeSubmit.push(function () {
                var isValid = true;
                setValue('who-staging.error', '');
                if (getValue('visitType.value') == 1163310 || getValue('visitType.value') == 1163311) {
                    <!-- clear the previous errors -->
                    if(jq('#sexualActive').length > 0){
                        setValue('sexualActive.error', '');
                    }
                    setValue('anySTIs.error', '');
                    if(jq('#disclosedToPartner').length > 0){
                        setValue('disclosedToPartner.error', '');
                    }
                    if(jq('#partnerStatus').length > 0){
                        setValue('partnerStatus.error', '');
                    }
                    if(jq('#screenForCancer').length > 0){
                        setValue('screenForCancer.error', '');
                    }
                    setValue('tbStatus.error', '');
                    setValue('POV.error', '');
                    setValue('septrinProbQuestion.error', '');
                    setValue('septrinDapsoneAdherence.error', '');
                    setValue('septrinDapsoneDaysMissed.error', '');
                    if(jq("#transfer").find(":checkbox:first").prop("checked") == false){
                        setValue('appointmentDate.error', '');
                    }

                    <!-- validate the required fields -->
                    if(jq('#sexualActive').length > 0){
                        if (getValue('sexualActive.value') == "") {
                            getField('sexualActive.error').html('Please select whether the patient is sexually active or not').show();
                            isValid = false;
                        }
                    }
                    if (getValue('anySTIs.value') == "") {
                        getField('anySTIs.error').html('Please select whether the patient has any symptoms of STIs').show();
                        isValid = false;
                    }
                    if(jq('#disclosedToPartner').length > 0){
                        if (getValue('disclosedToPartner.value') == "") {
                            getField('disclosedToPartner.error').html('Please select whether the patient has disclosed their status to their partner').show();
                            isValid = false;
                        }
                    }
                    if(jq('#partnerStatus').length > 0){
                        if (getValue('partnerStatus.value') == "") {
                            getField('partnerStatus.error').html('Please select the status of your partner').show();
                            isValid = false;
                        }
                    }
                    if(jq('#screenForCancer').length > 0){
                        if (getValue('screenForCancer.value') == "") {
                            getField('screenForCancer.error').html('Please select whether the client has been screened for cancer').show();
                            isValid = false;
                        }
                    }
                    if (getValue('tbStatus.value') == "") {
                        getField('tbStatus.error').html("Please select whether the client's TB status").show();
                        isValid = false;
                    }
                    if (getValue('POV.value') == "") {
                        getField('POV.error').html('Please select whether the client is eligible for POV').show();
                        isValid = false;
                    }
                }

                <!-- if the WHO staging status has changed from the last encounter then the reason why must be specified -->
                if (getValue('who-staging.value') != jq('#last-who-staging').text()) {
                    if(getValue('basis-for-who-stage-change.value') == "") {
                        getField('basis-for-who-stage-change.error').html('Please provide the reason for the WHO stage change').show();
                        isValid = false;
                    }
                }

                <!-- if CPT/Dapsone is not applicable then Adherence, Days missed and pill balance should not be required -->
                if (getValue('1193.value') != 1107) {
                    if(getValue('septrinProbQuestion.value') == "") {
                        getField('septrinProbQuestion.error').html('Please provide any problems with CPT/Dapsone since the last visit ').show();
                        isValid = false;
                    }
                    if(getValue('septrinDapsoneAdherence.value') == "") {
                        getField('septrinDapsoneAdherence.error').html('Please enter the Adherence for Septrin/Dapsone').show();
                        isValid = false;
                    }
                    if(getValue('septrinDapsoneDaysMissed.value') == "") {
                        getField('septrinDapsoneDaysMissed.error').html('Please enter the number of days missed for Septrin/Dapsone').show();
                        isValid = false;
                    }
                }

<!--                 Not to evaluate if patient is transferred out -->                
              if(jq("#transfer").find(":checkbox:first").prop("checked") == false){
               <!--Not to exceed number of booking for a specific return date. Default is 100 clients-->
               <!-- formatting date String from YYYY-MM-DD to DD/MM/YYYY to pass in the Url-->             
               var selectedDate = jq('#appointmentDate').find("input[type=hidden]").val();

               var formattedDate = changeFieldDateToJavascriptDate(selectedDate);
               var URL = window.location.origin + '/' + OPENMRS_CONTEXT_PATH + '/ws/rest/v1/ugandaemr/appointmentcount?nextAppointmentDate=' + formattedDate.replace(/['"]+/g, '') + '&amp;encounterType=8d5b2be0-c2cc-11de-8d13-0010c6dffd0f';
                
               var maxNumberOfBooked =  jq("#numberOfPatients").html();
               var numberOfAppointmentsOnSelectedDate = jq.ajax({
                     type: 'GET',
                     dataType: 'json',                   
                     url: URL,
                     async:false,
                     success: function(response){
                         if(response.appointmentcount &gt;= maxNumberOfBooked){
                            getField('appointmentDate.error').html('The patient cannot be scheduled on ' + formattedDate + ' because there are already ' + maxNumberOfBooked + ' booked').show();                       
                            isValid = false;
                         }
                     },
                    error: function(jqXHR, textStatus, errorThrown) {
                           getField('appointmentDate.error').html('Unable to determine the number of already booked patients on ' + formattedDate + ' due to ' + textStatus ).show();
                           isValid = false;
                        }  
              });
                 <!--Not to book on a public holiday-->
               var publicHolidayURL = window.location.origin + '/' + OPENMRS_CONTEXT_PATH + '/ws/rest/v1/ugandaemr/publicHoliday?date=' + formattedDate ;
               
               var isPublicHoliday = jq.ajax({
                     type: 'GET',                  
                     url: publicHolidayURL,
                     async:false,
                     success: function(response){
                         if(response.results.length){
                            getField('appointmentDate.error').html('Please enter another date because ' + formattedDate + ' is a public holiday of ' + response.results[0].name).show();
                            isValid = false;  
                         }
                     },
                    error: function(jqXHR, textStatus, errorThrown) {
                          getField('appointmentDate.error').html('Unable to determine if ' + formattedDate + ' is a public Holiday').show(); 
                            isValid = false;                      
                        }  
              });
            }
                if (!isValid) {
                    jq().toastmessage('showErrorToast', "  There are errors during the validation of the data on the form. Please correct them and submit again");
                }

                return isValid;

                
            });

            jq(document).ready(function () {

                /* Prompt if client is on TB Rx or completed it */
                var lastTBStatus = jq("#lastTBStatus").html();
                if(lastTBStatus == 90071){
                        jq().toastmessage('showNoticeToast',"Patient is on TB Treatment");
                    }else if(lastTBStatus == 99421){
                        jq().toastmessage('showNoticeToast',"Patient has completed TB Treatment");
                }

                /* Prompt for client ISS Stage */
                var latestWhoStage = jq("#latest-who-stage").html();
                if(latestWhoStage == 90033){
                    jq().toastmessage('showNoticeToast',"Patient is in Stage 1");
                }else if(latestWhoStage == 90034){
                    jq().toastmessage('showNoticeToast',"Patient is in Stage 2");
                }else if(latestWhoStage == 90035){
                    jq().toastmessage('showNoticeToast',"Patient is in Stage 3");
                }else if(latestWhoStage == 90036){
                    jq().toastmessage('showNoticeToast',"Patient is in Stage 4");
                }else if(latestWhoStage == 90293){
                    jq().toastmessage('showNoticeToast',"Patient is in Stage T1");
                }else if(latestWhoStage == 90294){
                    jq().toastmessage('showNoticeToast',"Patient is in Stage T2");
                }else if(latestWhoStage == 90295){
                    jq().toastmessage('showNoticeToast',"Patient is in Stage T3");
                }else if(latestWhoStage == 90296){
                    jq().toastmessage('showNoticeToast',"Patient is in Stage T4");
                }
               
                /* Prompt for malnutrition using Muac and BMI */
                var age = jq("#age").html();
                function BMI(ht,wt){
                   var htInMetres = ht/100;
                 return  wt/(htInMetres * htInMetres);
                }

                if(age &lt; 5){
                    if(( (jq("#lastMuac").html() &gt; 0) &amp;&amp; (jq("#lastMuac").html() &lt; 11.5)) || ( (BMI(jq("#lastHeight").html(),jq("#lastWeight").html()) &gt; 0)  &amp;&amp; (BMI(jq("#lastHeight").html(),jq("#lastWeight").html()) &lt; 14)) ){
                        jq().toastmessage('showNoticeToast',"Patient has malnutrition");
                   }
                } else if(age &lt; 10 ){
                    if(( (jq("#lastMuac").html() &gt; 0) &amp;&amp; (jq("#lastMuac").html() &lt; 13.5)) || ( (BMI(jq("#lastHeight").html(),jq("#lastWeight").html()) &gt; 0)  &amp;&amp; (BMI(jq("#lastHeight").html(),jq("#lastWeight").html()) &lt; 13.5)) ){
                        jq().toastmessage('showNoticeToast',"Patient has malnutrition");
                   }
                } else if(age &lt; 18 ){
                    if(( (jq("#lastMuac").html() &gt; 0) &amp;&amp; (jq("#lastMuac").html() &lt; 16.5)) || ( (BMI(jq("#lastHeight").html(),jq("#lastWeight").html()) &gt; 0)  &amp;&amp; (BMI(jq("#lastHeight").html(),jq("#lastWeight").html()) &lt; 18)) ){
                        jq().toastmessage('showNoticeToast',"Patient has malnutrition");
                   }
                } else {
                    if(( (jq("#lastMuac").html() &gt; 0) &amp;&amp; (jq("#lastMuac").html() &lt; 19)) || ( (BMI(jq("#lastHeight").html(),jq("#lastWeight").html()) &gt; 0)  &amp;&amp; (BMI(jq("#lastHeight").html(),jq("#lastWeight").html()) &lt; 18.5)) ){
                        jq().toastmessage('showNoticeToast',"Patient has malnutrition");
                   }
                }
               
                /* Validation of the ART regimen Selected */
                jq("#90315").change(function () {
                    var regimen_encounter_page_value = jq("#90315").find("select").find(":selected").val();
                    var regimen_encounter_page_text = jq("#90315").find("select").find(":selected").text();
                    var art_transfer_regimen = jq("#artTransferRegimen").html();
                    var other_art_transfer_regimen = jq("#otherArtTransferRegimen").html();
                    var art_start_regimen = jq("#artStartRegimen").html();
                    var other_art_start_regimen = jq("#otherArtStartRegimen").html();
                    var first_second_regimen = jq("#firstSecondLineRegimen").html();
                    var other_first_second_regimen = jq("#otherFirstSecondLineRegimen").html();
                    var third_second_regimen = jq("#thirdLineRegimen").html();
                    var other_third_regimen = jq("#otherThirdLineRegimen").html();
                    var patient_regimen = other_third_regimen + third_second_regimen + other_first_second_regimen + other_first_second_regimen + first_second_regimen + other_art_start_regimen + art_start_regimen + other_art_transfer_regimen + art_transfer_regimen;

                    /* Check if  Patient has art start or tranfer regimen selected on ART Summary Page*/
                    if (art_start_regimen == "null" &amp;&amp; art_transfer_regimen == "null") {
                        jq().toastmessage('showNoticeToast', "Patient Doesn't have any either ART Start or Transfer regimen on ART Summary selected");
                    }

                    if (!patient_regimen.includes(regimen_encounter_page_value)) {
                        jq().toastmessage('showNoticeToast', "The regimen " + regimen_encounter_page_text + " you have selected is different from the current regimen in the Summary page. Please update the summary page with a switch/substitution to the selected regimen");
                    }
                });

                jq('[class^="ARTYesNoEnableDisable"]').change(function () {
                    enable_disable(jq(this), "ARTYesNo", 'selected_value == "yes" &amp;&amp; selected_value!=""', "select");
                });

                jq('[class^="ARTYesNoEnableDisable"]').each(function () {
                    enable_disable(jq(this), "ARTYesNo", 'selected_value == "yes" &amp;&amp; selected_value!=""', "select");
                });

                jq('[class^="RegimenEnableDisable"]').change(function () {
                    enable_disable(jq(this), "Regimen", 'selected_value == "other"', "select");
                });

                jq('[class^="RegimenEnableDisable"]').each(function () {
                    enable_disable(jq(this), "Regimen", 'selected_value == "other"', "select");
                });

                jq('[class^="DistrictTbRegEnableDisable"]').change(function () {
                    enable_disable_district_tb_reg(jq(this));
                });

                jq('[class^="DistrictTbRegEnableDisable"]').each(function () {
                    enable_disable_district_tb_reg(jq(this));
                });


                jq('[class^="AdherenceEnableDisable"]').change(function () {
                    enable_disable(jq(this), "Adherence", 'selected_value == "poor" || selected_value=="fair"', "select");
                });

                jq('[class^="AdherenceEnableDisable"]').each(function () {
                    enable_disable(jq(this), "Adherence", 'selected_value == "poor" || selected_value=="fair"', "select");
                });


                jq('[class^="ViralLoadEnableDisable"]').change(function () {
                    enable_disable(jq(this), "ViralLoad", 'selected_value != "not detected" &amp;&amp; selected_value!=""', "select");
                });

                jq('[class^="ViralLoadEnableDisable"]').each(function () {
                    enable_disable(jq(this), "ViralLoad", 'selected_value != "not detected" &amp;&amp; selected_value!=""', "select");
                });


                jq(".enableDisable").each(function () {
                    var group = jq(this);

                    function disableFn() {
                        group.children("#disabled").fadeTo(250, 0.25);
                        /* group.children("#disabled").find(":checkbox").prop("checked", false); uncheck */
                        group.children("#disabled").find("input").prop("disabled", true);
                        /* disable */
                        group.children("#disabled").find("select").prop("disabled", true);
                    }

                    function enableFn() {
                        group.children("#disabled").fadeTo(250, 1);
                        group.children("#disabled").find("input").prop("disabled", false);
                        group.children("#disabled").find("select").prop("disabled", false);

                    }

                    if (jq(this).children("#trigger").find(":checkbox:first").prop("checked") != "checked") {
                        disableFn();
                    }

                    jq(this).children("#trigger").find(":checkbox:first").change(function () {
                        var checked = jq(this).prop("checked");
                        if (checked == true) {
                            enableFn();
                        } else {
                            disableFn();
                        }
                    });
                });

                <!-- Toogle showing Review when patient has been referred Out -->
                jq("#transfer").change(function() {
                    if(jq("#transfer").find(":checkbox:first").prop("checked") == true){
                        jq("#review").fadeTo(250, 0.25);
                        jq("#review").find(":checkbox").prop("checked", false);
                        jq("#review").find("input").val(""); 
                        jq("#review").find("textarea").val(""); 
                        jq("#review").find("input").prop("disabled", true); 
                        jq("#review").find("select").prop("disabled", true); 
                        jq("#review").find("textarea").prop("disabled", true); 
                        setValue('appointmentDate.error', '');

                    } else{
                        jq("#review").fadeTo(250, 1);
                        jq("#review").find("input").prop("disabled", false); 
                        jq("#review").find("select").prop("disabled", false); 
                        jq("#review").find("textarea").prop("disabled", false); 

                    }


                });

                jq(document).ready(function () {
                    $allRows = jq(this).find('.multi-drug');
                    $allRows.hide();
                    jq('#1-removeEntry').remove();
                    jq('#10-addEntry').remove();
                    jq('#1-toggleContainer').show();

                    jq('#11-removeEntry').remove();
                    jq('#20-addEntry').remove();
                    jq('#11-toggleContainer').show();
                });


                jq(document).ready(function () {
                    jq('.addEntry').on("click", function () {
                        var correctedAddButtonId = parseFloat(this.id) + 1;
                        var contentAddId = "#" + correctedAddButtonId + "-toggleContainer";
                        jq(contentAddId).toggle(true);
                        jq('#' + this.id).toggle(false);
                        jq('#' + parseFloat(this.id) + '-removeEntry').toggle(true);
                        return false;
                    });
                });

                jq(document).ready(function () {
                    jq('.removeEntry').on("click", function () {
                        var correctedRemoveButtonId = parseFloat(this.id) - 1;
                        var contentAddId = "#" + parseFloat(this.id) + "-toggleContainer";
                        jq(contentAddId).toggle(false);
                        jq(':input:not(:button)', contentAddId).val([]);
                        jq('#' + correctedRemoveButtonId + '-addEntry').toggle(true);
                        jq('#' + correctedRemoveButtonId + '-removeEntry').toggle(true);

                        return false;
                    });

                });

                jq(document).ready(function () {
                    $allRows_other = jq(this).find('.multi-drug-other');
                    $allRows_other.hide();
                    jq('#1-removeEntry-other').remove();
                    jq('#10-addEntry-other').remove();
                    jq('#1-toggleContainer-other').show();

                    jq('#11-removeEntry-other').remove();
                    jq('#20-addEntry-other').remove();
                    jq('#11-toggleContainer-other').show();
                });

                jq(document).ready(function () {
                    jq('.addEntry-other').on("click", function () {
                        var correctedAddButtonId = parseFloat(this.id) + 1;
                        var contentAddId = "#" + correctedAddButtonId + "-toggleContainer-other";
                        jq(contentAddId).toggle(true);
                        jq('#' + this.id).toggle(false);
                        jq('#' + parseFloat(this.id) + '-removeEntry-other').toggle(true);
                        return false;
                    });
                });

               jq(document).ready(function () {
                    jq('.removeEntry-other').on("click", function () {
                        var correctedRemoveButtonId = parseFloat(this.id) - 1;
                        var contentAddId = "#" + parseFloat(this.id) + "-toggleContainer-other";
                        jq(contentAddId).toggle(false);
                        jq(':input:not(:button)', contentAddId).val([]);
                        jq('#' + correctedRemoveButtonId + '-addEntry-other').toggle(true);
                        jq('#' + correctedRemoveButtonId + '-removeEntry-other').toggle(true);

                    return false;
                });

            });

            });
        }
    </script>

    <!-- This section contains lookup tags that pick data from other forms-->

    <lookup complexExpression="#set($art_start_regimen='null') #set($other_art_start_regimen='null') #set($art_transfer_regimen='null') #set($other_art_transfer_regimen='null')"/>

    <lookup complexExpression="#set($first_second_line_regimen='null') #set($other_first_second_line_regimen='null')"/>

    <lookup complexExpression="#set($third_line_regimen='null') #set($other_third_line_regimen='null')"/>

    <span style="display: none" id="artStartRegimen"><lookup
            complexExpression="#set($art_start_regimen=($fn.latestObs('99061').valueCoded))$art_start_regimen"/></span>

    <span style="display: none" id="otherArtStartRegimen"><lookup
            complexExpression="#set($other_art_start_regimen=($fn.latestObs('99268').valueText))$other_art_start_regimen"/></span>

    <span style="display: none" id="artTransferRegimen"><lookup
            complexExpression="#set($art_transfer_regimen=$fn.latestObs('99064').valueCoded)$art_transfer_regimen"/></span>

    <span style="display: none" id="otherArtTransferRegimen"><lookup
            complexExpression="#set($other_art_transfer_regimen=$fn.latestObs('99269').valueText)$other_art_transfer_regimen"/></span>

    <span style="display: none" id="firstSecondLineRegimen"><lookup
            complexExpression="#foreach($first_second_line_regimen in $fn.allObs(90315)) $first_second_line_regimen.valueCoded #end"/></span>

    <span style="display: none" id="otherFirstSecondLineRegimen"><lookup
            complexExpression="#foreach($other_first_second_line_regimen in $fn.allObs(99146)) $other_first_second_line_regimen.valueText #end"/></span>


    <span style="display: none" id="thirdLineRegimen"><lookup
            complexExpression="#foreach($third_line_regimen in $fn.allObs(162990)) $first_second_line_regimen.valueCoded #end"/></span>

    <span style="display: none" id="otherThirdLineRegimen"><lookup
            complexExpression="#foreach($other_third_line_regimen in $fn.allObs(162989)) $other_first_second_line_regimen.valueText #end"/></span>
    
    <span style="display: none" id="lastMuac"><lookup expression="fn.earliestObs('CIEL:1343').valueNumeric"/></span>
    <span style="display: none" id="lastWeight"><lookup expression="fn.earliestObs('CIEL:5089').valueNumeric"/></span>
    <span style="display: none" id="lastHeight"><lookup expression="fn.earliestObs('CIEL:5090').valueNumeric"/></span>
    <span style="display: none" id="age"><lookup expression="patient.age"/></span>

    <span style="display: none" id="numberOfPatients"><lookup expression="fn.globalProperty('ugandaemr.maximumPatientsPerDay')"/></span>
    <span style="display: none" id="lastTBStatus"><lookup expression="fn.earliestObs('90216').valueCoded.conceptId"/></span>
    <span style="display: none" id="latest-who-stage"><lookup expression="fn.earliestObs('90203').valueCoded.conceptId"/></span>
   
    <!--End of Lookup section-->

    <div class="ai-page-frame">
        <div class="headers" style="text-align: center;">
            <h3>HIV Care/ART CARD - Encounter Page</h3>
        </div>
        <span style="display: none;">
            <encounterLocation default="629d78e9-93e5-43b0-ad8a-48313fd99117"
                               order="629d78e9-93e5-43b0-ad8a-48313fd99117"/>
        </span>




        <section>
            <table>
                <tbody>
                    <tr>
                        <td style="width: 15%;background: #F3F3F3;">Date
                            <br/>
                            Tick box if scheduled
                        </td>
                        <td style="width: 15%;background: #F3F3F3;">Type of Visit</td>
                    </tr>
                    <tr>
                        <td>
                            <encounterDate default="today" disallowMultipleEncountersOnDate="block"/>
                            <br/>
                            <obs id="br" conceptId="90069" labelText="Scheduled?" style="checkbox"/>
                        </td>
                        <td>
                            <obs id="visitType" conceptId="1163173" answerConceptIds="1163310,1163311,1163307,1163175,1163312,1163313" answerLabels="1-Facility,2-Community,3-POV,4-Nurse,5-Sick,6-Represented" labelText="Type of Visit:" required="true" />
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="presentingComplaints">
            <table>
                <tbody>
                    <tr>
                        <td style="width: 15%;background: #F3F3F3;">Presenting complaints
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <obs conceptId="1163314" cols="80" rows="5" />
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section id="reasonForNotComing">
            <table>
                <tbody>
                    <tr>
                        <td style="width: 15%;background: #F3F3F3;">Reason for not coming
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <obs conceptId="1163315" cols="80" rows="2" />
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="firstSection">
            <table>
                <tbody>
                    <tr>
                        <td style="width: 15%;background: #F3F3F3;">Duration in months since first starting ART/since
                            starting current regimen
                        </td>
                        <includeIf velocityTest="$patient.age &gt;=14"><td style="width: 15%;background: #F3F3F3;">Prevention with Positives/If pregnant EDD/EMTCT? Write gestation in weeks
                            and ANC#
                        </td></includeIf>
                    </tr>
                    <tr>
                        <td>
                            <obs id="br" conceptId="99024" labelText="Duration(Months since baseline):"/>
                            <br/>
                            <obs id="br" conceptId="99025" labelText="Duration:(Months on current regimen)"/>
                        </td>
                        <includeIf velocityTest="$patient.age &gt;=14"><td>
                            <obs id="sexualActive" conceptId="99624" answerConceptIds="1065,1066"
                                 answerLabels="Yes,No" labelText="Is Patient Sexually active">
                                <controls>
                                    <when value="1065" thenDisplay=".fpSection" />
                                </controls>
                            </obs>
                            <excludeIf velocityTest="$patient.gender =='M' || $patient.age &lt; 9">
                                <span class="ARTYesNoEnableDisable2">
                                    <span class="fpSection">
                                        <obs conceptId="90041" style="checkbox" answerConceptIds="1065,1066"
                                            answerLabels="Yes,No" labelText="Pregnant"/>
                                    </span>
                                </span>
                                <span class="">
                                    <obs conceptId="1163317" style="checkbox" answerConceptIds="1065,1066"
                                         answerLabels="Yes,No" labelText="Lactating"/>
                                </span>
                                <span class="ARTYesNoEnableDisableChild2 fpSection">
                                    <obs conceptId="5596" labelText="EDD:" allowFutureDates="true"/>
                                    <br/>
                                    <obs conceptId="99325" labelText="LNMP:" />
                                    <br/>
                                </span>
                                <span class="ARTYesNoEnableDisableChild2 fpSection">
                                    <obs conceptId="90012" labelText="eMTCT Connected:" answerConceptIds="90003,90004"
                                         answerLabels="Yes,No"/>
                                    <obs conceptId="90027" labelText="Ever taken NVP or AZT during Pregnancy" />
                                </span>
                            </excludeIf>
                            <excludeIf velocityTest="$patient.age &lt; 9">
                                <excludeIf velocityTest="$patient.gender =='M'">
                                    <br/>
                                    <span class="ARTYesNoEnableDisableChild2 fpSection">
                                        <obs conceptId="162983" labelText="Gestation in Weeks"/>
                                        <br/>
                                        ANC #
                                        <patient field="identifier" identifierTypeId="b0cc255e-ef57-4266-839e-0df7f5099eb9"
                                                 required="false"/>
                                        <br/>
                                    </span>
                                </excludeIf>
                                <span class="fpSection">
                                    <span id="checkboxRadio">
                                        <span class="ARTYesNoEnableDisable1">
                                            <obs id="br" conceptId="90238" answerConceptIds="90082,90081" answerLabels="Yes,No"
                                                 labelText="Family Planning?"/>
                                        </span>
                                    </span>
                                    <br/>
                                    <span class="ARTYesNoEnableDisableChild1 fpSection">
                                        Family Planning Method:
                                        <br/>
                                        <obs id="br" conceptId="374" answerConceptId="190" answerLabel="1 - Condoms"/>
                                        <excludeIf velocityTest="$patient.gender =='M' ">
                                            <span class="lablex2">
                                                <obs id="br" conceptId="374" answerConceptId="780"
                                                     answerLabel="2 - Oral Contraceptive pills"/>
                                                <obs id="br" conceptId="374" answerConceptId="5279"
                                                     answerLabel="3 - Injectable/Implantable hormonies"/>
                                                <obs id="br" conceptId="374" answerConceptId="5278"
                                                     answerLabel="4 - Diaphram/Cervical Cap"/>
                                                <obs id="br" conceptId="374" answerConceptId="5275"
                                                     answerLabel="5 - Intra uterine device (IUD)"/>
                                                <obs id="br" conceptId="374" answerConceptId="5277"
                                                    answerLabel="7 - Fertility Awareness Methods"/>
                                            </span>
                                        </excludeIf>
                                        <obs id="br" conceptId="374" answerConceptId="99265"
                                             answerLabel="6 - Vasectomy/Tubal ligation"/>
                                    </span>
                                </span>
                                <br/>
                                <!--
                                <excludeIf velocityTest="$patient.gender =='M'">
                                    <span class="ARTYesNoEnableDisableChild3">
                                    <obs id="br" conceptId="99270" labelText="Age in months"/>
                                    </span>
                                </excludeIf>
                                 -->
                            </excludeIf>

                        </td>
                        </includeIf>
                    </tr>
                </tbody>
            </table>
        </section>
        <section id="secondSection">
            <table>
                <tbody>
                    <tr>
                        <td style="width: 15%;background: #F3F3F3;padding: 20px;">STI Symptom Screening</td>

                        <includeIf velocityTest="$patient.age &gt;=14">
                            <td style="width: 15%;background: #F3F3F3;padding: 20px;">Disclosure Status</td>
                        </includeIf>
                        <excludeIf velocityTest="$patient.gender =='M'">
                            <td style="width: 15%;background: #F3F3F3;padding: 20px;">Cervical Cancer screening</td>
                        </excludeIf>
                        <td style="width: 15%;background: #F3F3F3;padding: 20px;">TB Status / TB Rx / District TB</td>
                    </tr>
                    <tr>
                        <td>
                            <label>Are there any symptoms of an STI?</label>
                            <obs id="anySTIs" conceptId="1163177" answerConceptIds="1065,1066" answerLabels="Yes,No">
                                <controls>
                                    <when value="1065" thenDisplay="#stiSymptoms" />
                                </controls>
                            </obs>
                            <span id="stiSymptoms">
                                <label>If yes, symptoms:</label>
                                <obs id="stiSymptomsList" conceptId="1163320" answerConceptIds="145762, 123396, 123529, 157544, 5622" answerLabels="Genital Ulcers, Abnormal Vaginal Discharge, Urethral Discharge, Lower Abdominal Pain, Other">
                                    <controls>
                                        <when value="5622" thenDisplay="#stiSymptomsOther" />
                                </controls>
                                </obs>
                                <span id="stiSymptomsOther">
                                    Other STI Symptoms:
                                    <obs conceptId="1163178"/>
                                </span>

                            </span>
                        </td>
                        <includeIf velocityTest="$patient.age &gt;=14"><td>
                            <div class="row"><div class="col-md-12">
                                <label>Have you disclosed your HIV status to your spouse/sexual partner?</label>
                                <obs id="disclosedToPartner" conceptId="1163179" answerConceptIds="90003,90004,1175" answerLabels="Yes,No,N/A"/>
                            </div></div>
                            <div class="row"><div class="col-md-12">
                                <obs id="partnerStatus" conceptId="99630" answerConceptIds="703,664,90001,1175" answerLabels="Pos,Neg,Unk,N/A" labelText="Partner Status:">
                                    <controls>
                                        <when value="703" thenDisplay="#partnerInCare" />
                                    </controls>
                                </obs>
                            </div></div>
                            <span id="partnerInCare">
                                <label>If Positive is he/she accessing care?</label>
                                <obs id="isPartnerIncare" conceptId="1163180">
                                    <controls>
                                        <when value="90003" thenDisplay="#whereInCare" />
                                    </controls>
                                </obs>
                                <span id="whereInCare">
                                    <label>Name of clinic:</label>
                                    <obs id="clinicQn" conceptId="1163181" answerConceptIds="1163182,5622" answerLabels="Mulago ISS Clinic,Other">
                                        <controls>
                                            <when value="5622" thenDisplay="#whereInCareOther" />
                                        </controls>
                                    </obs>
                                </span>
                                <span id="whereInCareOther">
                                    <obs conceptId="1163318" />
                                </span>
                            </span>

                        </td></includeIf>
                        <excludeIf velocityTest="$patient.gender =='M' ">
                            <td>
                                <label>Screen for Cancer of the cervix in the past 1 year</label>
                                <obs id="screenForCancer" conceptId="1163183">
                                    <controls>
                                        <when value="90003" thenDisplay="#cancerResults" />
                                    </controls>
                                </obs>
                                <span id="cancerResults">
                                    <label>Results:</label>
                                    <obs id="cancerR stls" conceptId="1163184" answerConceptIds="703,664" answerLabels="Pos,Neg">
                                        <controls>
                                            <when value="703" thenDisplay="#actionTakenCancer" />
                                        </controls>
                                    </obs>
                                </span>
                                <span id="actionTakenCancer">
                                    <label>Action taken:</label>
                                    <obs conceptId="1163316"/>
                                </span>
                                
                                    <div class="row col-md-12">
                                    <obs conceptId="99350" answerConceptIds="99348,99347,1118" answerLabels="FOM - Cervix is free of malignancy,SS - Cervix is suspicious of malignancy,ND - Not Done" class="long-value-select" labelText="Status Of The Cervix"/>
                                    </div>
                            </td>
                        </excludeIf>
                        <td>
                            <span class="DistrictTbRegEnableDisable1">
                                <obs id="tbStatus" conceptId="90216" labelText="Tb Status"
                                     answerConceptIds="90079,90073,90078,90071,99421"
                                     answerLabels="No signs,Suspect,Diagnosed with Tb,Tb Rx,Tb Rx Completed"/>
                            </span>
                            <span class="DistrictTbRegEnableDisableChild1">
                                <obs id="br" conceptId="90217" labelText="TB Start Date:"/>
                                <obs id="br" conceptId="90310" labelText="TB Stop Date:" allowFutureDates="true"/>

                            </span>
                            <label>District TB No.</label>
                            <span class="DistrictTbRegEnableDisableChild1">
                                <patient field="identifier" identifierTypeId="8110f2d2-1f98-4c38-aef3-11b19bb0a589"
                                         required="false"/>
                            </span>

                            <br/>
                        </td>
                    </tr>
                </tbody>
            </table>

            <div class="card">
                <div class="card-header">Potential side effects</div>
                <div class="card-body">
                    <div class="row enableDisable">
                        <obs conceptId="90227" answerConceptId="90100" answerLabel="AB" class="col-md-3"/>
                        <obs conceptId="90227" answerConceptId="90099" answerLabel="Anaemia" class="col-md-3"/>
                        <obs conceptId="90227" answerConceptId="90095" answerLabel="BN" class="col-md-3"/>
                        <obs conceptId="90227" answerConceptId="90117" answerLabel="CNS" class="col-md-3"/>
                        <obs conceptId="90227" answerConceptId="90092" answerLabel="Diarrhoea" class="col-md-3"/>
                        <obs conceptId="90227" answerConceptId="90116" answerLabel="FAT" class="col-md-3"/>
                        <obs conceptId="90227" answerConceptId="90093" answerLabel="Fatigue" class="col-md-3"/>
                        <obs conceptId="90227" answerConceptId="90094" answerLabel="Headache" class="col-md-3"/>
                        <obs conceptId="90227" answerConceptId="90115" answerLabel="Jaundice" class="col-md-3"/>
                        <obs conceptId="90227" answerConceptId="90091" answerLabel="Nausea" class="col-md-3"/>
                        <obs conceptId="90227" answerConceptId="90098" answerLabel="Rash" class="col-md-3"/>
                        <obs id="trigger" conceptId="90227" answerConceptId="90002" answerLabel="Other specify:" class="col-md-3"/>
                        <div class="col-md-3"></div><div class="col-md-3"></div><div class="col-md-3"></div>
                        <obs id="disabled" conceptId="99113" size="17" class="col-md-3"/>
                    </div>
                </div>
            </div>
        </section>
        <section id="diagnosisSection">
            <div class="card">
                <div class="card-header">Diagnosis</div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-12">
                            <encounterDiagnoses required="false" selectedDiagnosesTarget=""
                                                preferredCodingSource="ICD-10-WHO"/>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="advancedDiseaseSection">
            <div class="card">
                <div class="card-header">Advanced Disease Status and WHO Clinical Stage
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <obs conceptId="165272"
                                 answerConceptIds="165309, 165266, 165267, 165268, 165269, 165270, 165271"
                                 answerLabels="1 - No Adv. Disease, 2 - Suspected Adv. Disease, 3a - Confirmed Adv. Disease CD4 &lt; 200, 3b - Confirmed Adv. Disease - Pos CrAg,
                             3c - Confirmed Adv. Disease - Pos TB, 3d - Confirmed Adv. Disease - WHO Stage 3/4, 3e - Confirmed Adv. Disease - Child &lt; 5 Yrs"    labelText="Advanced Disease Status"/>
                        </div>
                        <div class="col-md-3"></div>
                        <div class="col-md-4">
                            <obs id="who-clinic-stage"  conceptId="90203"
                                 answerConceptIds="90033,90034,90035,90036,90293,90294,90295,90296"
                                 answerLabels="1,2,3,4,T1,T2,T3,T4" labelText="WHO Clinical stages"/>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="hepatitisBStatusSection">
            <div class="card">
                <div class="card-header">Hepatitis B status and Syphilis Status</div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <obs conceptId="1322" answerConceptIds="159971,90001"
                                 labelText="Hep B Status" answerLabels="T - Tested, NT - Not Tested" />
                        </div>
                        <div class="col-md-4">
                            <obs id="1322" conceptId="1322" answerConceptIds="703,664"
                                 labelText="Hep B Results (if tested)" answerLabels="Pos - Positive,Neg - Negative"  />
                        </div>
                        <div class="col-md-4">
                            <obs conceptId="99753" 
                                 answerConceptIds="162848,99756,99755,99754"
                                 labelText="Syphilis Status" answerLabels=" 1 - No symptoms, 2 - Symptomatic Non-Reactive, 3 - Symptomatic Reactive, 4 - Symptomatic Reactive and treated"/>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="thirdSection">
            <table>
                <tbody>
                    <tr>
                        <td style="width: 15%;background: #F3F3F3;padding: 20px;">New OI / Problems</td>
                        <td style="width: 15%;background: #F3F3F3;padding: 20px;">Functional Status</td>
                        <td style="width: 15%;background: #F3F3F3;padding: 20px;">WHO Clinical stage</td>
                    </tr>
                    <tr>

                        <td class="lablex2">
                            <obs id="br" conceptId="90251" answerConceptId="90132" answerLabel="Cough"/>
                            <obs id="br" conceptId="90251" answerConceptId="90133"
                                 answerLabel="DB"/>
                            <obs id="br" conceptId="90251" answerConceptId="90128"
                                 answerLabel="Dementia"/>
                            <obs id="br" conceptId="90251" answerConceptId="162849"
                                 answerLabel="Ear Infection"/>
                            <obs id="br" conceptId="90251" answerConceptId="90129"
                                 answerLabel="Enceph"/>
                            <obs id="br" conceptId="90251" answerConceptId="90131"
                                 answerLabel="Fever"/>
                            <obs id="br" conceptId="90251" answerConceptId="162850"
                                 answerLabel="Poor Growth"/>
                            <obs id="br" conceptId="90251" answerConceptId="162847"
                                 answerLabel="Palpaple Lymph Nodes"/>
                            <obs id="br" conceptId="90251" answerConceptId="512"
                                 answerLabel="Skin Rash"/>
                            <obs id="br" conceptId="90251" answerConceptId="90138"
                                 answerLabel="GUD"/>
                            <obs id="br" conceptId="90251" answerConceptId="90094"
                                 answerLabel="Headache"/>
                            <obs id="br" conceptId="90251" answerConceptId="90134"
                                 answerLabel="IRIS"/>
                            <obs id="br" conceptId="90251" answerConceptId="123"
                                 answerLabel="Malaria"/>
                            <obs id="br" conceptId="90251" answerConceptId="162851"
                                 answerLabel="Acute Diarrhea"/>
                            <obs id="br" conceptId="90251" answerConceptId="5018"
                                 answerLabel="Persistent Diarrhea"/>
                            <obs id="br" conceptId="90251" answerConceptId="162852"
                                 answerLabel="Recurrent Diarrhea"/>
                            <obs id="br" conceptId="90251" answerConceptId="5334"
                                 answerLabel="Oral Thrush"/>
                            <obs id="br" conceptId="90251" answerConceptId="90127"
                                 answerLabel="Pneumonia"/>
                            <obs id="br" conceptId="90251" answerConceptId="90137"
                                 answerLabel="PID"/>
                            <obs id="br" conceptId="90251" answerConceptId="999"
                                 answerLabel="RTI"/>
                            <obs id="br" conceptId="90251" answerConceptId="90130"
                                 answerLabel="Thrush"/>
                            <obs id="br" conceptId="90251" answerConceptId="90136"
                                 answerLabel="UD"/>
                            <obs id="br" conceptId="90251" answerConceptId="90139"
                                 answerLabel="Ulcers"/>
                            <obs id="br" conceptId="90251" answerConceptId="106"
                                 answerLabel="URTI"/>
                            <obs id="br" conceptId="90251" answerConceptId="90135"
                                 answerLabel="Weight loss"/>
                            <obs id="br" conceptId="90251" answerConceptId="90126"
                                 answerLabel="Zoster"/>
                            <obs id="br" conceptId="90251" answerConceptId="507"
                                 answerLabel="KS"/>
                            <obs id="br" conceptId="90251" answerConceptId="1294"
                                 answerLabel="CCM"/>
                            <span class="enableDisable">
                                <span id="trigger">
                                    <obs conceptId="90251" answerConceptId="90002" answerLabel="Other specify:"/>
                                </span>
                                <span id="disabled">
                                    <obs conceptId="99032" size="17" answerClasses="Diagnosis"
                                         style="autocomplete"/>
                                </span>
                            </span>
                            <br/>
                        </td>
                        <td>
                            <obs conceptId="90235" answerConceptIds="90037,90038,90039"
                                 answerLabels="Amb,Work, Bed" labelText="" required="true"/>
                        </td>
                        <td>
                            <span id="last-who-staging" class="hidden"><lookup expression="fn.latestObs('90203').valueCoded.conceptId"/></span>
                            <obs id="who-staging" conceptId="90203"
                                 answerConceptIds="90033,90034,90035,90036,90293,90294,90295,90296"
                                 answerLabels="1,2,3,4,T1,T2,T3,T4" labelText="" required="true"/>
                            <obs id="basis-for-who-stage-change" conceptId="1163204" labelText="If changed, basis for change"/><br/>
                            <obs id="br" conceptId="5497" dateLabel="Date:" labelText="CD4:"/>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section id="forthSection">
            <table>
                <tbody>
                    <tr>
                        <td style="width: 5%;background: #F3F3F3;padding: 20px;">CPT/Dapsone</td>
                        <td style="width: 5%;background: #F3F3F3;padding: 20px;">INH</td>
                        <td style="width: 5%;background: #F3F3F3;padding: 20px;">ART Eligibility</td>
                        <td style="width: 15%;background: #F3F3F3;padding: 20px; text-align: center;" colspan="2">ARV
                            drugs
                        </td>
                    </tr>
                    <tr>
                        <td >
                            <p class="hasInlineLabels">
                                <obs id="1193" conceptId="1193" answerConceptIds="916,90171,1107"
                                     answerLabels="Septrin,Dapson,Not Applicable" style="radio" answerSeparator="&lt;br/>" required="true"/>
                            </p>
                            <span id="SeptrinExperience">
                                <label>Did client experience any problem since last visit?</label>
                                <obs id="septrinProbQuestion" conceptId="1163185" answerConceptIds="90003,90004,1175" answerLabels="Yes,No,N/A">
                                    <controls>
                                        <when value="90003" thenDisplay="#septrinProblems" />
                                    </controls>
                                </obs>
                                <span id="septrinProblems">
                                    <label>if yes What?</label>
                                    <obs conceptId="1163186" answerConceptIds="512,1163187,1163188,1163189,99113" answerLabels="Skin rash,Skin Itching,Skin peeling,Patch on skin,Others" />
                                </span>
                            </span>
                            <obs id="septrinDapsoneAdherence" conceptId="90220" answerConceptIds="90156,90157,90158"
                                 answerLabels=" Good, Fair, Poor" labelText="Adherence:"/>
                            <br/>
                            <label>Number of days Missed:</label><obs id="septrinDapsoneDaysMissed" conceptId="1163190" answerConceptIds="1107,1163191,1163192,1163193,1163194,1163195,1163196" answerLabels="0,1,2,3,4,5,>5"/>
                            <obs conceptId="1163263" labelText="Pill Balance:" />
                            <obs conceptId="99037" labelText="# Pills Dispensed:"/>
                            <obs conceptId="99033" labelText="Days:"/>
                        </td>

                        <td>
                            <select name="TB prophylaxis" id="TBprophylaxis">
                                <option value="INH">INH</option>
                                <option value="3HP">3HP</option>
                            </select>
                            <span id="INH">
                            <obs conceptId="99604" labelText="# Pills Dispensed:"/>
                            <obs conceptId="99605" labelText="Days:"/>
                            <obs conceptId="90215" labelText="INH Start Date"/>
                            <obs conceptId="165793" labelText="INH End Date" allowFutureDates="true"/>
                            </span>
                            <span id="3HP">
                                <obs conceptId="165885" labelText="# Pills Dispensed:"/>
                                <obs conceptId="165886" labelText="Days:"/>
                                <obs conceptId="165878" labelText="3HP Start Date"/>
                                <obs conceptId="165879" labelText="3HP End Date" allowFutureDates="true"/>
                            </span>
                            <obs conceptId="165880" labelText="Pyridoxine # Pills Dispensed:"/>
                        </td>
                        <td>
                            <obs id="eligibleQn" conceptId="99415" answerConceptIds="1065,1066" answerLabels="Yes,No" labelText="On ART:" required="true" >
                                <controls>
                                    <when value="1066" thenDisplay=".notonARTSection" />
                                </controls>
                            </obs>
                            <span class="notonARTSection">
                                <obs id="eligibleAnswer" conceptId="1358" answerConceptIds="1359,1364" labelText="Eligible for ART">
                                    <controls>
                                        <when value="1364" thenDisplay="#whyNotEligibleSection" />
                                    </controls>
                                </obs>
                            </span>
                            <span id="whyNotEligibleSection" class="notonARTSection">
                                <obs id="whyNotEligibleForART" conceptId="1163197" labelText="Why not Eligible:" >
                                    <when value="5622" thenDisplay="#otherReasonNotEligibleForART" />
                                </obs>
                            </span>
                            <span id="otherReasonNotEligibleForART">
                               <obs conceptId="1163203" labelText="Why not Eligible:" />
                            </span>
                        </td>
                        <td class="EnableDisableAdherenceReason checkboxGroup lablex3 ARVSections">
                            <span class="AdherenceEnableDisable1">
                                <obs conceptId="90221" answerConceptIds="90156,90157,90158"
                                     answerLabels=" Good, Fair, Poor" labelText="Adhererence:"/>
                            </span>
                            <span class="AdherenceEnableDisableChild1">
                                Why Poor/Fair:
                                <br/>
                                <obs id="br" conceptId="90223" answerConceptId="90040"
                                     answerLabel="1 - Toxicity"/>
                                <obs id="br" conceptId="90223" answerConceptId="90146"
                                     answerLabel="2 - Share with others"/>
                                <obs id="br" conceptId="90223" answerConceptId="90147"
                                     answerLabel="3 - Forgot"/>
                                <obs id="br" conceptId="90223" answerConceptId="90148"
                                     answerLabel="4 - Felt better"/>
                                <obs id="br" conceptId="90223" answerConceptId="90149"
                                     answerLabel="5 - Too ill"/>
                                <obs id="br" conceptId="90223" answerConceptId="90150"
                                     answerLabel="6 - Stigma"/>
                                <obs id="br" conceptId="90223" answerConceptId="90045"
                                     answerLabel="7 - Drug Stock out"/>
                                <obs id="br" conceptId="90223" answerConceptId="90151"
                                     answerLabel="8 - Lost pills"/>
                                <obs id="br" conceptId="90223" answerConceptId="90152"
                                     answerLabel="9 - Travel problems"/>
                                <obs id="br" conceptId="90223" answerConceptId="90051"
                                     answerLabel="10 - Inability to pay"/>
                                <obs id="br" conceptId="90223" answerConceptId="90153"
                                     answerLabel="11 - Alcohol"/>
                                <obs id="br" conceptId="90223" answerConceptId="90154"
                                     answerLabel="12 - Depression"/>
                                <obs id="br" conceptId="90223" answerConceptId="90155"
                                     answerLabel="13 - Pill burden"/>
                                <obs id="br" conceptId="90223" answerConceptId="99049"
                                     answerLabel="14 - Lack of food"/>
                                <span id="trigger">
                                    <obs id="br" conceptId="90223" answerConceptId="90002"
                                         answerLabel="15 - Other Specify:"/>
                                </span>
                                <span id="disabled">
                                    <obs id="br" conceptId="99125" labelText="" size="21"/>
                                </span>
                            </span>
                        </td>
                        <td class="ARVSections" style="width:3%;">
                            <span class="disableARTRegimen">
                                <excludeIf velocityTest="$patient.age &lt;15">
                                    <span class="RegimenEnableDisable1">
                                        <obs id="90315" conceptId="90315" labelText="Regimen:" class="long-value-select" />
                                       <!--  answerConceptIds="99005,     99006         ,99039         ,99040          ,99044          ,99046           ,99284           ,99286           ,99885         ,99888           ,163017          ,99887           ,164977      ,164978    ,90002"
                                         answerLabels="1c-AZT-3TC-NVP,1d-AZT-3TC-EFV,1e-TDF-3TC-NVP,1f-TDF-3TC-EFV,2b-TDF-3TC-LPV/r,2e-AZT-3TC-LPV/r,2c-AZT-ABC-LPV/r,2j-AZT-3TC-ATV/r,1i-ABC-3TC-EFV,2h-ABC-3TC-ATV/r,2g-ABC-3TC-LPV/r,2f-TDF-3TC-ATV/r,TDF/3TC/DTG,ABC/3TC/DTG,Other"/> -->
                                    </span>
                                    <span class="RegimenEnableDisableChild1">
                                        <obs id="br" conceptId="99126" size="18" labelText="Specify"/>
                                        <br/>
                                    </span>
                                </excludeIf>
                                <excludeIf velocityTest="$patient.age &gt;14">
                                    <span class="RegimenEnableDisable1">
                                        <obs id="90315" conceptId="90315" labelText="Regimen:" class="long-value-select"/>
                                       <!--  answerConceptIds="99005,99006,99039,99040,99044,99046,99284,99286,99885,99888,163017,90002,164977,99887,164978"
                                         answerLabels="4c-AZT-3TC-NVP,4d-AZT-3TC-EFV,4j-TDF-3TC-NVP,4i-TDF-3TC-EFV,5b-TDF-3TC-LPV/r,4h-AZT-3TC-LPV/r,5l-AZT-3TC-ATV/r,5j-ABC-3TC-NVP,5i-ABC-3TC-EFV,5m-ABC-3TC-ATV/r,5k-ABC-3TC-LPV/r,TDF/3TC/DTG,ABC/3TC/DTG,2f-TDF-3TC-ATV/r,Other"/> -->
                                    </span>
                                    <span class="RegimenEnableDisableChild1">
                                        <obs id="br" conceptId="99126" size="18" labelText="Specify"/>
                                        <br/>
                                    </span>
                                </excludeIf>
                                <obs id="br" conceptId="99038" labelText="Pill Balance:"/>
                                <obs id="br" conceptId="99038" labelText="# Pills Dispensed:"/>
                                <obs id="br" conceptId="99036" size="5" labelText="Days:"/>
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="fluconazoleSection">
            <div class="card">
                <div class="card-header">
                    Fluconazole
                </div>
                <div class="card-body">
                    <obsgroup groupingConceptId="165306">
                        <div class="row">
                            <div class="col-md-2">
                                <br/>
                                <obs conceptId="1282" answerConceptSetIds="165308"
                                     answerConceptIds="747"
                                     answerLabels="Fluconazole"
                                     style="radio"
                                     class="horizontal"/>
                            </div>
                            <div class="col-md-2">
                                <obs labelText="No. of Pills" conceptId="160856"/>
                            </div>
                            <div class="col-2 duration">
                                <obs conceptId="159368" labelText="No. of Days"/>
                            </div>

                            <div class="col-md-2">
                                <obs conceptId="1190" labelText="Start Date"/>
                            </div>
                            <div class="col-md-2">
                                <obs conceptId="1191" labelText="Stop Date"/>
                            </div>
                        </div>
                    </obsgroup>
                </div>
            </div>
        </section>
        <section id="essentialMedicationsSection">
            <div class="card">
                <div class="card-header">
                    <label>Essential Medications</label>
                </div>
                <div class="card-body">
                    <div>
                        <repeat>
                            <template>
                                <obsgroup groupingConceptId="160741">
                                    <div class="row multi-drug" id="{id}-toggleContainer">
                                        <div class="col-2">
                                            <obs labelText="Drugs"  id="{id}-drug" conceptId="1282" answerClasses="Drug" style="autocomplete" class="fullwidth"/>
                                        </div>
                                        <div class="col-2">
                                            <obs labelText="Quantity" conceptId="160856"/>
                                        </div>
                                        <div class="col-2">
                                            <obs labelText="Qty unit" conceptId="165791" answerConceptSetIds="162402,162384"/>
                                        </div>
                                        <div class="col-2 duration">
                                            <obs conceptId="159368" labelText="Duration"/>
                                        </div>
                                        <div class="col-2">
                                            <obs conceptId="1732" labelText="Duration unit"/>
                                        </div>
                                        <div class="col-2">
                                            <div class="add-entry mt-4">
                                                <a href="#" id="{id}-addEntry" class="addEntry add-more-link"><i class="icon-plus-sign"></i></a>
                                                <a href="#" class="removeEntry remove-more-link" id="{id}-removeEntry"><i class="icon-minus"></i></a>
                                            </div>
                                        </div>
                                    </div>
                                </obsgroup>
                            </template>
                            <render id="1"/>
                            <render id="2"/>
                            <render id="3"/>
                            <render id="4"/>
                            <render id="5"/>
                            <render id="6"/>
                            <render id="7"/>
                            <render id="8"/>
                            <render id="9"/>
                            <render id="10"/>
                        </repeat>
                    </div>
                </div>
            </div>
        </section>
        <section id="otherMedicationsSection">
            <div class="card">
                <div class="card-header">
                    <label>Other Medications</label>
                </div>
                <div class="card-body">
                    <div>
                        <repeat>
                            <template>
                                <obsgroup groupingConceptId="165874">
                                    <div class="row multi-drug-other" id="{id}-toggleContainer-other">
                                        <div class="col-2">
                                            <obs labelText="Drug" id="{id}-drugother" conceptId="99035" class="fullwidth"/>
                                        </div>
                                        <div class="col-2">
                                            <obs labelText="Quantity" conceptId="160856"/>
                                        </div>
                                        <div class="col-2">
                                            <obs labelText="Qty unit" conceptId="165791" answerConceptSetIds="162402,162384"/>
                                        </div>
                                        <div class="col-2 duration">
                                            <obs conceptId="159368" labelText="Duration"/>
                                        </div>
                                        <div class="col-2">
                                            <obs conceptId="1732" labelText="Duration unit"/>
                                        </div>
                                        <div class="col-2">
                                            <div class="add-entry mt-4">
                                                <a href="#" id="{id}-addEntry-other" class="addEntry-other add-more-link"><i class="icon-plus-sign"></i></a>
                                                <a href="#" class="removeEntry-other remove-more-link" id="{id}-removeEntry-other"><i class="icon-minus"></i></a>
                                            </div>
                                        </div>
                                    </div>
                                </obsgroup>
                            </template>
                            <render id="1"/>
                            <render id="2"/>
                            <render id="3"/>
                            <render id="4"/>
                            <render id="5"/>
                            <render id="6"/>
                            <render id="7"/>
                            <render id="8"/>
                            <render id="9"/>
                            <render id="10"/>
                        </repeat>
                    </div>
                </div>
            </div>
        </section>

        <section id="fifthSection">
            <div class="card">
                <div class="card-header">POV Assessement</div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <obs id="POV" conceptId="1163271" answerConceptIds="90003,90004" answerLabels="1-Yes,2-No" labelText="Is Patient Eligible for POV?">
                                <controls><when value="90004" thenDisplay="#povSection"/></controls>
                            </obs>
                        </div>
                        <div id="povSection" class="col-md-6">
                            <obs id="reasonForDenyingPOV" conceptId="1163279" answerConceptIds="90049,1163272,1163273,90040,90041,1163274,1163275,1163276,1163277,1163278,165051,90280,163164,163159,5622" answerLabels="1-Poor Adherence,2-Missed appt in last 3months,3-KS lessthan 90,4-ART toxicities,5-Pregnant,6-On ART lessthan 1year,7-non ART CD4 lessthan 500,8-Co-morbidities,9-On 2nd line therapy,10-Dropping CD4 by morethan 100,11-Lactating,12-Child,13-On 3rd Line Regimen,14-Non suppressed,15-Others" labelText="Specify reason for denying the patient POV">
                                <controls>
                                    <when value="5622" thenDisplay="#otherPOVEligibility" />
                                </controls>
                            </obs>
                            <span id="otherPOVEligibility">
                                <obs conceptId="1163319" labelText="Specify:" />
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="sixthSection">
            <div class="card">
                <div class="card-header">
                    Tests ordered
                </div>
                <div class="card-body">
                    <div class="row enableDisable" >
            
                        <obs conceptId="1271" answerConceptId="1019" answerLabel="CBC" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="99152" answerLabel="RPR" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="12" answerLabel="CXR" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="21" answerLabel="Hgb" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="657" answerLabel="Cd4" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="856" answerLabel="VL" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="307" answerLabel="Sputums" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="99149" answerLabel="Infant Ab/PCR" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="953" answerLabel="LFT" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="1163309" answerLabel="RFT" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="1031" answerLabel="TPHA" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="165849" answerLabel="RBS" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="161509" answerLabel="HCG" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="165418" answerLabel="CrAg" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="165416" answerLabel="TBLAM" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="165415" answerLabel="Microscopy" class="col-md-3"/>
                    
                        <obs conceptId="1271" answerConceptId="165413" answerLabel="GeneXpert" class="col-md-3"/>
                        <obs id="trigger" conceptId="1271" answerConceptId="90002" answerLabel="Other specify:" class="col-md-3"/>
                        <obs id="disabled" conceptId="99114" size="16" labelText="" class="col-md-3"/>
                    </div>
                    <label>Significant Positive findings on examination</label>
                    <div class="row col-md-12">
                        <obs cols="30" rows="3" conceptId="1163270" />
                    </div>
                </div>
            </div>
        </section>
        <section id="appointmentSection">
            <table>
                <tbody>
                    <div class="card">
                        <div class="card-header">
                            Issues to Re-Evaluate on next visit and Re-Evaluation Date
                        </div>
                        <div class="card-body">
                            <div class="row enableDisable" >
                                <obs conceptId="160288" answerConceptId="164968"   answerLabel="ART Initiation" class="col-md-3"/>
                                <obs conceptId="160288" answerConceptId="164972"   answerLabel="ART Refill" class="col-md-3" />
                                <obs conceptId="160288" answerConceptId="164970"   answerLabel="ART Regimen Switch/ Substitution" class="col-md-3" />
                                <obs conceptId="160288" answerConceptId="856"   answerLabel="Viral Load" class="col-md-3"/>
                                <obs conceptId="160288" answerConceptId="5497"   answerLabel="CD4" class="col-md-3"/>
                                <obs conceptId="160288" answerConceptId="163153"  answerLabel="IAC" class="col-md-3"/>
                                <obs conceptId="160288" answerConceptId="164971"     answerLabel="T.B Drug Refill" class="col-md-3"/>
                                <obs conceptId="160288" answerConceptId="164973"  answerLabel="T.B Follow up" class="col-md-3"/>
                                <obs conceptId="160288" answerConceptId="99324"  answerLabel="ANC" class="col-md-3"/>
                                <obs conceptId="160288" answerConceptId="164974"  answerLabel="EID" class="col-md-3"/>
                                <obs conceptId="160288" answerConceptId="90012"     answerLabel="PMTCT" class="col-md-3"/>
                                <obs conceptId="160288" answerConceptId="903"  answerLabel="Hypertension/ Diabetes" class="col-md-3"/>
                                <obs conceptId="160288" answerConceptId="5484"  answerLabel="Nutrition" class="col-md-3"/>
                                <obs id="trigger" conceptId="160288" answerConceptId="90002"  
                                     answerLabel="Other Specify" class="col-md-3"/>
                                <div class="col-md-3">
                                    <label>Other Reason for next appointment</label>
                                    <obs id="disabled" conceptId="164975"/>
                                </div>
                                <excludeIf velocityTest="$patient.person.dead == true">
                                    <obs id="appointmentDate" conceptId="5096" required="false" allowFutureDates="true" labelText="Re-evaluation date:" 
                                         class="col-md-3"/>
                                </excludeIf>
                            </div>
                        </div>
                    </div>
                </tbody>
            </table>
        </section>

        <section id="dsdmSection">
            <table>
                <tbody>
                    <div class="card">
                        <div class="card-header">DSD Model</div>
                        <div class="card-body">
                            <div class="row">
                                <obs id="duration-on-current-regimen" conceptId="99025" labelText="Duration on Current Regimen" class="col-md-3"/>
                                <obs id="duration-on-art" conceptId="99024" class="col-md-3" labelText="Duration on ART"/>
                                <obs id="patient-categorization" conceptId="165144"
                                     answerConceptIds="90003,90004"
                                     answerLabels="S - Stable, US - Unstable"
                                     class="horizontal col-md-3" labelText="Patient Categorization"/>
                                <obs id="165143" conceptId="165143"
                                     answerConceptIds="165138,165140,165139,165142,165141"
                                     answerLabels="FBIM - Facility Based Individual Management, FBG - Facility Based Group, FTDR - Fast-Track Drug Refills, CDDP - Community Drug Distribution Point, CCLAD - Community Client-Led ART Delivery"
                                     class="long-value-select col-md-3" required="required" labelText="Approach"/>
                            </div>
                            <div class="row"><div class="col-md-6">
                                <label>Visit Type</label>
                                <obs conceptId="160288" answerConceptIds="164969,165284"
                                         answerLabels="R - Drug Refill ONLY, C - Clinical Assessment/Drug refill and/or Tests/Investigations"
                                         style="radio" class="horizontal" />
                                </div>
                            </div>
                        </div>
                    </div>
                </tbody>
            </table>
        </section>

        <section id="referral">
            <div class="card">
                <div class="card-header">Transfer and Referral</div>
                <div class="card-body">
                    <div class="row">
                        <obs id="transfer" conceptId="90306" answerConceptId="90003"
                             answerLabel="Transferred out" class="col-md-2"/>
                        <obs conceptId="90211" labelText="To:" class="col-md-3"/>
                    </div>
                    <div class="row">
                        <label>Referred for</label>
                        <obs conceptId="99054" answerConceptId="99053"
                             answerLabel="Theraputic Feeding" class="col-md-2"/>
                        <obs conceptId="99054" answerConceptId="99051"
                             answerLabel="Infant F C" class="col-md-2"/>
                        <obs conceptId="99054" answerConceptId="99052"
                             answerLabel="Nutrition C" class="col-md-2"/>
                        <obs conceptId="99054" answerConceptId="99050"
                             answerLabel="Food Support" class="col-md-2"/>
                        <obs size="15" conceptId="99267" labelText="Other referral:" class="col-md-2"/>
                    </div>
                    <div class="row enableDisable">
                        <label>Action Taken</label>
                        <span id="review">
                            <obs conceptId="1163264" answerConceptId="90003"
                                answerLabel="Requested Counselling" class="col-md-2"/>
                            <obs conceptId="1163268" answerConceptId="90003"
                                answerLabel="Treated current OIs" class="col-md-2"/>
                            <obs conceptId="1358" answerConceptId="1362"
                                answerLabel="Started on ART" class="col-md-2"/>
                        </span>
                        <obs id="trigger" conceptId="1163265" answerConceptId="90003"
                             answerLabel="Initiate POV" class="col-md-3"/>
                        <div class="col-md-3">
                            <label>POV date</label>
                            <obs id="disabled" conceptId="1163266" allowFutureDates="true"/>
                        </div>
                    </div>
                    <div class="row">
                        <obs conceptId="1151" answerConceptIds="5526,99089,6046"
                             answerLabels="EBF,RF,MF" labelText="Infant feeding" class="col-md-3" />
                        <obs conceptId="90224" labelText="# Hospitalized days:" class="col-md-3"/>
                    </div>
                </div>
            </div>
        </section>

            <section>
                <table>
                    <tr>
                        <td>
                            <label><span class="required">*</span>Name of Clinician:
                            </label>
                            <encounterProvider role="Provider" style="autocomplete"/>
                        </td>
                    </tr>
                </table>
            </section>
            <section>
                <submit/>
            </section>
        </div>
    <script>
        jQuery(document).ready(function() {
            var visitTypeValue = getValue('visitType.value');
            if (visitTypeValue == '') {
                jQuery('#reasonForNotComing').css('display','none');
                jQuery("#presentingComplaints").css('display','none');
                jQuery('#firstSection').css('display','none');
                jQuery('#secondSection').css('display','none');
                jQuery('#thirdSection').css('display','none');
                jQuery('#forthSection').css('display','none');
                jQuery('#fifthSection').css('display','none');
                jQuery('#sixthSection').css('display','none');

                jQuery('#appointmentSection').css('display','none');
                jQuery('#diagnosisSection').css('display','none');
                jQuery('#advancedDiseaseSection').css('display','none');
                jQuery('#hepatitisBStatusSection').css('display','none');
                jQuery('#fluconazoleSection').css('display','none');
                jQuery('#essentialMedicationsSection').css('display','none');
                jQuery('#otherMedicationsSection').css('display','none');
                jQuery('#dsdmSection').css('display','none');
                jQuery('#referral').css('display','none');
            }


            if (visitTypeValue == 1163310 || visitTypeValue == 1163311 || visitTypeValue == 1163307) {
                jQuery('#reasonForNotComing').css('display','none');
                jQuery("#presentingComplaints").css('display','block');
                jQuery('#firstSection').css('display','block');
                jQuery('#secondSection').css('display','block');
                jQuery('#thirdSection').css('display','block');
                jQuery('#forthSection').css('display','block');
                jQuery('#fifthSection').css('display','block');
                jQuery('#sixthSection').css('display','block');

                jQuery('#appointmentSection').css('display','block');
                jQuery('#diagnosisSection').css('display','block');
                jQuery('#advancedDiseaseSection').css('display','block');
                jQuery('#hepatitisBStatusSection').css('display','block');
                jQuery('#fluconazoleSection').css('display','block');
                jQuery('#essentialMedicationsSection').css('display','block');
                jQuery('#otherMedicationsSection').css('display','block');
                jQuery('#dsdmSection').css('display','block');
                jQuery('#referral').css('display','block');
            }

            if (visitTypeValue == 1163175) {
                jQuery('#reasonForNotComing').css('display','none');
                jQuery("#presentingComplaints").css('display','none');
                jQuery('#firstSection').css('display','block');
                jQuery('#secondSection').css('display','block');
                jQuery('#thirdSection').css('display','block');
                jQuery('#forthSection').css('display','block');
                jQuery('#fifthSection').css('display','block');
                jQuery('#sixthSection').css('display','block');

                jQuery('#appointmentSection').css('display','block');
                jQuery('#diagnosisSection').css('display','block');
                jQuery('#advancedDiseaseSection').css('display','block');
                jQuery('#hepatitisBStatusSection').css('display','block');
                jQuery('#fluconazoleSection').css('display','block');
                jQuery('#essentialMedicationsSection').css('display','block');
                jQuery('#otherMedicationsSection').css('display','block');
                jQuery('#dsdmSection').css('display','block');
                jQuery('#referral').css('display','block');
            }

            if (visitTypeValue == 1163312) {
                jQuery('#reasonForNotComing').css('display','none');
                jQuery("#presentingComplaints").css('display','block');
                jQuery('#firstSection').css('display','none');
                jQuery('#secondSection').css('display','block');
                jQuery('#thirdSection').css('display','block');
                jQuery('#forthSection').css('display','block');
                jQuery('#fifthSection').css('display','none');
                jQuery('#sixthSection').css('display','block');

                jQuery('#appointmentSection').css('display','block');
                jQuery('#diagnosisSection').css('display','block');
                jQuery('#advancedDiseaseSection').css('display','block');
                jQuery('#hepatitisBStatusSection').css('display','block');
                jQuery('#fluconazoleSection').css('display','block');
                jQuery('#essentialMedicationsSection').css('display','block');
                jQuery('#otherMedicationsSection').css('display','block');
                jQuery('#dsdmSection').css('display','block');
                jQuery('#referral').css('display','block');
            }

            if (visitTypeValue == 1163313) {
                jQuery('#reasonForNotComing').css('display','block');
                jQuery("#presentingComplaints").css('display','none');
                jQuery('#firstSection').css('display','none');
                jQuery('#secondSection').css('display','none');
                jQuery('#thirdSection').css('display','block');
                jQuery('#forthSection').css('display','block');
                jQuery('#fifthSection').css('display','none');
                jQuery('#sixthSection').css('display','block');

                jQuery('#appointmentSection').css('display','block');
                jQuery('#diagnosisSection').css('display','block');
                jQuery('#advancedDiseaseSection').css('display','block');
                jQuery('#hepatitisBStatusSection').css('display','block');
                jQuery('#fluconazoleSection').css('display','block');
                jQuery('#essentialMedicationsSection').css('display','block');
                jQuery('#otherMedicationsSection').css('display','block');
                jQuery('#dsdmSection').css('display','block');
                jQuery('#referral').css('display','block');
            }

            var TBprophylaxisValue = jQuery("#TBprophylaxis option:selected").val();
            if (TBprophylaxisValue == 'INH') {
                jQuery('#INH').removeClass("hidden");
                jQuery("#3HP").addClass("hidden");
                }else{
                    jQuery('#INH').addClass("hidden");
                    jQuery("#3HP").removeClass("hidden");
                }
        });

        jQuery(function() {
        getField('visitType.value').change(function() {
        var visitTypeValue = getValue('visitType.value');
        if (visitTypeValue == '') {
        jQuery('#reasonForNotComing').css('display','none');
        jQuery("#presentingComplaints").css('display','none');
        jQuery('#firstSection').css('display','none');
        jQuery('#secondSection').css('display','none');
        jQuery('#thirdSection').css('display','none');
        jQuery('#forthSection').css('display','none');
        jQuery('#fifthSection').css('display','none');
        jQuery('#sixthSection').css('display','none');
        jQuery('#appointmentSection').css('display','none');
        jQuery('#diagnosisSection').css('display','none');
        jQuery('#advancedDiseaseSection').css('display','none');
        jQuery('#hepatitisBStatusSection').css('display','none');
        jQuery('#fluconazoleSection').css('display','none');
        jQuery('#essentialMedicationsSection').css('display','none');
        jQuery('#otherMedicationsSection').css('display','none');
        jQuery('#dsdmSection').css('display','none');
        jQuery('#referral').css('display','none');
        }


        if (visitTypeValue == 1163310 || visitTypeValue == 1163311 || visitTypeValue == 1163307) {
        jQuery('#reasonForNotComing').css('display','none');
        jQuery("#presentingComplaints").css('display','block');
        jQuery('#firstSection').css('display','block');
        jQuery('#secondSection').css('display','block');
        jQuery('#thirdSection').css('display','block');
        jQuery('#forthSection').css('display','block');
        jQuery('#fifthSection').css('display','block');
        jQuery('#sixthSection').css('display','block');
        jQuery('#appointmentSection').css('display','block');
        jQuery('#diagnosisSection').css('display','block');
        jQuery('#advancedDiseaseSection').css('display','block');
        jQuery('#hepatitisBStatusSection').css('display','block');
        jQuery('#fluconazoleSection').css('display','block');
        jQuery('#essentialMedicationsSection').css('display','block');
        jQuery('#otherMedicationsSection').css('display','block');
        jQuery('#dsdmSection').css('display','block');
        jQuery('#referral').css('display','block');
        }

        if (visitTypeValue == 1163175) {
        jQuery('#reasonForNotComing').css('display','none');
        jQuery("#presentingComplaints").css('display','none');
        jQuery('#firstSection').css('display','block');
        jQuery('#secondSection').css('display','block');
        jQuery('#thirdSection').css('display','block');
        jQuery('#forthSection').css('display','block');
        jQuery('#fifthSection').css('display','block');
        jQuery('#sixthSection').css('display','block');
        jQuery('#appointmentSection').css('display','block');
        jQuery('#diagnosisSection').css('display','block');
        jQuery('#advancedDiseaseSection').css('display','block');
        jQuery('#hepatitisBStatusSection').css('display','block');
        jQuery('#fluconazoleSection').css('display','block');
        jQuery('#essentialMedicationsSection').css('display','block');
        jQuery('#otherMedicationsSection').css('display','block');
        jQuery('#dsdmSection').css('display','block');
        jQuery('#referral').css('display','block');
        }

        if (visitTypeValue == 1163312) {
        jQuery('#reasonForNotComing').css('display','none');
        jQuery("#presentingComplaints").css('display','block');
        jQuery('#firstSection').css('display','none');
        jQuery('#secondSection').css('display','block');
        jQuery('#thirdSection').css('display','block');
        jQuery('#forthSection').css('display','block');
        jQuery('#fifthSection').css('display','none');
        jQuery('#sixthSection').css('display','block');
        jQuery('#appointmentSection').css('display','block');
        jQuery('#diagnosisSection').css('display','block');
        jQuery('#advancedDiseaseSection').css('display','block');
        jQuery('#hepatitisBStatusSection').css('display','block');
        jQuery('#fluconazoleSection').css('display','block');
        jQuery('#essentialMedicationsSection').css('display','block');
        jQuery('#otherMedicationsSection').css('display','block');
        jQuery('#dsdmSection').css('display','block');
        jQuery('#referral').css('display','block');
        }

        if (visitTypeValue == 1163313) {
        jQuery('#reasonForNotComing').css('display','block');
        jQuery("#presentingComplaints").css('display','none');
        jQuery('#firstSection').css('display','none');
        jQuery('#secondSection').css('display','none');
        jQuery('#thirdSection').css('display','block');
        jQuery('#forthSection').css('display','block');
        jQuery('#fifthSection').css('display','none');
        jQuery('#sixthSection').css('display','block');
        jQuery('#appointmentSection').css('display','block');
        jQuery('#diagnosisSection').css('display','block');
        jQuery('#advancedDiseaseSection').css('display','block');
        jQuery('#hepatitisBStatusSection').css('display','block');
        jQuery('#fluconazoleSection').css('display','block');
        jQuery('#essentialMedicationsSection').css('display','block');
        jQuery('#otherMedicationsSection').css('display','block');
        jQuery('#dsdmSection').css('display','block');
        jQuery('#referral').css('display','block');
        }

        });
        });

        jQuery('#TBprophylaxis').on('change', function () {
            var TBprophylaxisValue = jQuery("#TBprophylaxis option:selected").val();
            if (TBprophylaxisValue == 'INH') {
            jQuery('#INH').removeClass("hidden");
            jQuery("#3HP").addClass("hidden");
            }else{
                jQuery('#INH').addClass("hidden");
                jQuery("#3HP").removeClass("hidden");
            }
       });

        if(getValue('eligibleQn.value') == '') {
            jQuery(".ARVSections select").prop("disabled", true);
            jQuery(".ARVSections input").prop("disabled", true);
            jQuery(".ARVSections input").fadeTo(250, 0.25);
        }

        jQuery(function() {
            getField('eligibleQn.value').change(function() {
                if(getValue('eligibleQn.value') == '' || getValue('eligibleQn.value') == 1066 ) {
                    jQuery(".ARVSections select").prop("disabled", true);
                    jQuery(".ARVSections input").prop("disabled", true);
                    jQuery(".ARVSections input").fadeTo(250, 0.25);
                }
                else {
                    jQuery(".ARVSections select").prop("disabled", false);
                    jQuery(".ARVSections input").fadeTo(250, 1);
                }
            });
        });
    </script>
</htmlform>
